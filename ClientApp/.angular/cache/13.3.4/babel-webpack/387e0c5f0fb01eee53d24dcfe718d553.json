{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\Study\\\\PIRIS\\\\Lab1_piris\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { firstValueFrom } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"../router-params.service\";\nvar ActionType;\n\n(function (ActionType) {\n  ActionType[ActionType[\"AuthAccount\"] = 1] = \"AuthAccount\";\n  ActionType[ActionType[\"AuthPin\"] = 2] = \"AuthPin\";\n  ActionType[ActionType[\"SelectActions\"] = 3] = \"SelectActions\";\n  ActionType[ActionType[\"Balance\"] = 4] = \"Balance\";\n  ActionType[ActionType[\"MenuOrExit\"] = 5] = \"MenuOrExit\";\n  ActionType[ActionType[\"Withdraw\"] = 6] = \"Withdraw\";\n  ActionType[ActionType[\"Blocked\"] = 7] = \"Blocked\";\n})(ActionType || (ActionType = {}));\n\nexport class AtmComponent {\n  constructor(route, http, router, params, baseUrl) {\n    this.route = route;\n    this.http = http;\n    this.router = router;\n    this.params = params;\n    this.baseUrl = baseUrl;\n    this.currActionType = ActionType.AuthAccount;\n    this.balance = 0;\n    this.accountNumber = 0;\n    this.pin = '1111';\n    this.invalidAttemptsCount = 0;\n  }\n\n  ngOnInit() {}\n\n  pinEntered() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        yield firstValueFrom(_this.http.post(_this.baseUrl + 'atm/pin', {\n          accountNumber: _this.accountNumber,\n          pin: _this.pin\n        }));\n      } catch (e) {\n        _this.invalidAttemptsCount++;\n\n        if (_this.invalidAttemptsCount >= 3) {\n          _this.currActionType = ActionType.Blocked;\n        }\n\n        alert('Неверный номер карты или пин');\n      }\n\n      _this.invalidAttemptsCount = 0;\n      _this.currActionType = ActionType.SelectActions;\n    })();\n  }\n\n  accountEntered() {\n    this.currActionType = ActionType.AuthPin;\n  }\n\n  menuSelected() {\n    this.currActionType = ActionType.AuthPin;\n  }\n\n  balanceSelected() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.balance = yield firstValueFrom(_this2.http.get(_this2.baseUrl + 'atm'));\n      _this2.currActionType = ActionType.Balance;\n\n      if (prompt('Печатать чек?')) {\n        alert(`Ваш баланс - ${_this2.balance}`);\n      }\n    })();\n  }\n\n  withdrawSelected() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      _this3.balance = yield firstValueFrom(_this3.http.get(_this3.baseUrl + 'atm'));\n      _this3.currActionType = ActionType.Balance;\n\n      if (prompt('Печатать чек?')) {\n        alert(`Ваш баланс - ${_this3.balance}`);\n      }\n    })();\n  }\n\n}\n\nAtmComponent.ɵfac = function AtmComponent_Factory(t) {\n  return new (t || AtmComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.RouterParamsService), i0.ɵɵdirectiveInject('BASE_URL'));\n};\n\nAtmComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AtmComponent,\n  selectors: [[\"app-atm\"]],\n  decls: 2,\n  vars: 0,\n  template: function AtmComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"atm works!\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhdG0uY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"sources":["D:/Study/PIRIS/Lab1_piris/ClientApp/src/app/atm/atm.component.ts"],"names":["firstValueFrom","i0","i1","i2","i3","ActionType","AtmComponent","constructor","route","http","router","params","baseUrl","currActionType","AuthAccount","balance","accountNumber","pin","invalidAttemptsCount","ngOnInit","pinEntered","post","e","Blocked","alert","SelectActions","accountEntered","AuthPin","menuSelected","balanceSelected","get","Balance","prompt","withdrawSelected","ɵfac","AtmComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","HttpClient","Router","RouterParamsService","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","template","AtmComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","styles"],"mappings":"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","sourcesContent":["import { firstValueFrom } from \"rxjs\";\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/router\";\r\nimport * as i2 from \"@angular/common/http\";\r\nimport * as i3 from \"../router-params.service\";\r\nvar ActionType;\r\n(function (ActionType) {\r\n    ActionType[ActionType[\"AuthAccount\"] = 1] = \"AuthAccount\";\r\n    ActionType[ActionType[\"AuthPin\"] = 2] = \"AuthPin\";\r\n    ActionType[ActionType[\"SelectActions\"] = 3] = \"SelectActions\";\r\n    ActionType[ActionType[\"Balance\"] = 4] = \"Balance\";\r\n    ActionType[ActionType[\"MenuOrExit\"] = 5] = \"MenuOrExit\";\r\n    ActionType[ActionType[\"Withdraw\"] = 6] = \"Withdraw\";\r\n    ActionType[ActionType[\"Blocked\"] = 7] = \"Blocked\";\r\n})(ActionType || (ActionType = {}));\r\nexport class AtmComponent {\r\n    constructor(route, http, router, params, baseUrl) {\r\n        this.route = route;\r\n        this.http = http;\r\n        this.router = router;\r\n        this.params = params;\r\n        this.baseUrl = baseUrl;\r\n        this.currActionType = ActionType.AuthAccount;\r\n        this.balance = 0;\r\n        this.accountNumber = 0;\r\n        this.pin = '1111';\r\n        this.invalidAttemptsCount = 0;\r\n    }\r\n    ngOnInit() {\r\n    }\r\n    async pinEntered() {\r\n        try {\r\n            await firstValueFrom(this.http.post(this.baseUrl + 'atm/pin', {\r\n                accountNumber: this.accountNumber,\r\n                pin: this.pin\r\n            }));\r\n        }\r\n        catch (e) {\r\n            this.invalidAttemptsCount++;\r\n            if (this.invalidAttemptsCount >= 3) {\r\n                this.currActionType = ActionType.Blocked;\r\n            }\r\n            alert('Неверный номер карты или пин');\r\n        }\r\n        this.invalidAttemptsCount = 0;\r\n        this.currActionType = ActionType.SelectActions;\r\n    }\r\n    accountEntered() {\r\n        this.currActionType = ActionType.AuthPin;\r\n    }\r\n    menuSelected() {\r\n        this.currActionType = ActionType.AuthPin;\r\n    }\r\n    async balanceSelected() {\r\n        this.balance = await firstValueFrom(this.http.get(this.baseUrl + 'atm'));\r\n        this.currActionType = ActionType.Balance;\r\n        if (prompt('Печатать чек?')) {\r\n            alert(`Ваш баланс - ${this.balance}`);\r\n        }\r\n    }\r\n    async withdrawSelected() {\r\n        this.balance = await firstValueFrom(this.http.get(this.baseUrl + 'atm'));\r\n        this.currActionType = ActionType.Balance;\r\n        if (prompt('Печатать чек?')) {\r\n            alert(`Ваш баланс - ${this.balance}`);\r\n        }\r\n    }\r\n}\r\nAtmComponent.ɵfac = function AtmComponent_Factory(t) { return new (t || AtmComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.RouterParamsService), i0.ɵɵdirectiveInject('BASE_URL')); };\r\nAtmComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AtmComponent, selectors: [[\"app-atm\"]], decls: 2, vars: 0, template: function AtmComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"p\");\r\n        i0.ɵɵtext(1, \"atm works!\");\r\n        i0.ɵɵelementEnd();\r\n    } }, styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhdG0uY29tcG9uZW50LmNzcyJ9 */\"] });\r\n"]},"metadata":{},"sourceType":"module"}