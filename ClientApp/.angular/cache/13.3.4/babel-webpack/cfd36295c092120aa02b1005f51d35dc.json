{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\Study\\\\PIRIS\\\\Lab1_piris\\\\ClientApp\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { firstValueFrom } from \"rxjs\";\nimport * as moment from \"moment/moment\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"../../../../router-params.service\";\nexport class CreditComponent {\n  constructor(route, http, router, params, baseUrl) {\n    this.route = route;\n    this.http = http;\n    this.router = router;\n    this.params = params;\n    this.baseUrl = baseUrl;\n    this.isCreateMode = false;\n    this.timeSpan = 3;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.isCreateMode = !_this.params.creditId;\n      _this.lookUps = yield firstValueFrom(_this.http.get(_this.baseUrl + 'lookups/credit'));\n\n      _this.refreshCredit();\n    })();\n  }\n\n  refreshCredit() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        clientId,\n        creditId\n      } = _this2.params;\n\n      if (!_this2.isCreateMode) {\n        _this2.credit = yield firstValueFrom(_this2.http.get(_this2.baseUrl + 'clients/' + clientId + '/credit/' + creditId));\n        console.log(_this2.credit);\n      } else {\n        _this2.credit = {\n          contractNumber: \"\",\n          currencyType: {\n            id: 1,\n            name: \"\"\n          },\n          amount: 0,\n          startDate: new Date(),\n          creditType: undefined,\n          endDate: moment().add(_this2.timeSpan, 'months').toDate(),\n          nextInterestPayDate: undefined,\n          id: 0,\n          isActive: true,\n          interestAccount: undefined,\n          creditAccount: undefined\n        };\n      }\n    })();\n  }\n\n  save() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const id = yield firstValueFrom(_this3.http.post(_this3.baseUrl + 'clients/' + _this3.params.clientId + '/credit', _this3.credit)).catch(p => alert('Вы попытались сломать систему. Соответствующая информация будет отправлена вашему непосредственному начальнику'));\n      yield _this3.router.navigateByUrl(`/clients/` + _this3.params.clientId + '/credits/' + id);\n      alert('Депозит успешно сохранён');\n      yield _this3.ngOnInit();\n    })();\n  }\n\n  updateDates() {\n    // @ts-ignore\n    this.credit.endDate = moment().add(this.timeSpan, 'months').toDate();\n  }\n\n  payInterest() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      yield firstValueFrom(_this4.http.post(_this4.baseUrl + 'clients/' + _this4.params.clientId + '/credit/' + _this4.params.creditId + '/pay-interest', null));\n      alert('Готово!');\n    })();\n  }\n\n  close() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      yield firstValueFrom(_this5.http.post(_this5.baseUrl + 'clients/' + _this5.params.clientId + '/credit/' + _this5.params.creditId + '/close', null));\n      alert('Депозит закрыт.');\n      yield _this5.ngOnInit();\n    })();\n  }\n\n}\n\nCreditComponent.ɵfac = function CreditComponent_Factory(t) {\n  return new (t || CreditComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.RouterParamsService), i0.ɵɵdirectiveInject('BASE_URL'));\n};\n\nCreditComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CreditComponent,\n  selectors: [[\"app-credit\"]],\n  decls: 2,\n  vars: 0,\n  template: function CreditComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\");\n      i0.ɵɵtext(1, \"credit works!\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjcmVkaXQuY29tcG9uZW50LmNzcyJ9 */\"]\n});","map":{"version":3,"sources":["D:/Study/PIRIS/Lab1_piris/ClientApp/src/app/clients/client-general/credits/credit/credit.component.ts"],"names":["firstValueFrom","moment","i0","i1","i2","i3","CreditComponent","constructor","route","http","router","params","baseUrl","isCreateMode","timeSpan","ngOnInit","creditId","lookUps","get","refreshCredit","clientId","credit","console","log","contractNumber","currencyType","id","name","amount","startDate","Date","creditType","undefined","endDate","add","toDate","nextInterestPayDate","isActive","interestAccount","creditAccount","save","post","catch","p","alert","navigateByUrl","updateDates","payInterest","close","ɵfac","CreditComponent_Factory","t","ɵɵdirectiveInject","ActivatedRoute","HttpClient","Router","RouterParamsService","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","template","CreditComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","styles"],"mappings":"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","sourcesContent":["import { firstValueFrom } from \"rxjs\";\r\nimport * as moment from \"moment/moment\";\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/router\";\r\nimport * as i2 from \"@angular/common/http\";\r\nimport * as i3 from \"../../../../router-params.service\";\r\nexport class CreditComponent {\r\n    constructor(route, http, router, params, baseUrl) {\r\n        this.route = route;\r\n        this.http = http;\r\n        this.router = router;\r\n        this.params = params;\r\n        this.baseUrl = baseUrl;\r\n        this.isCreateMode = false;\r\n        this.timeSpan = 3;\r\n    }\r\n    async ngOnInit() {\r\n        this.isCreateMode = !this.params.creditId;\r\n        this.lookUps = await firstValueFrom(this.http.get(this.baseUrl + 'lookups/credit'));\r\n        this.refreshCredit();\r\n    }\r\n    async refreshCredit() {\r\n        const { clientId, creditId } = this.params;\r\n        if (!this.isCreateMode) {\r\n            this.credit = await firstValueFrom(this.http.get(this.baseUrl + 'clients/' + clientId + '/credit/' + creditId));\r\n            console.log(this.credit);\r\n        }\r\n        else {\r\n            this.credit = {\r\n                contractNumber: \"\",\r\n                currencyType: {\r\n                    id: 1,\r\n                    name: \"\"\r\n                },\r\n                amount: 0,\r\n                startDate: new Date(),\r\n                creditType: undefined,\r\n                endDate: moment().add(this.timeSpan, 'months').toDate(),\r\n                nextInterestPayDate: undefined,\r\n                id: 0,\r\n                isActive: true,\r\n                interestAccount: undefined,\r\n                creditAccount: undefined\r\n            };\r\n        }\r\n    }\r\n    async save() {\r\n        const id = await firstValueFrom(this.http.post(this.baseUrl + 'clients/' + this.params.clientId + '/credit', this.credit))\r\n            .catch(p => alert('Вы попытались сломать систему. Соответствующая информация будет отправлена вашему непосредственному начальнику'));\r\n        await this.router.navigateByUrl(`/clients/` + this.params.clientId + '/credits/' + id);\r\n        alert('Депозит успешно сохранён');\r\n        await this.ngOnInit();\r\n    }\r\n    updateDates() {\r\n        // @ts-ignore\r\n        this.credit.endDate = moment().add(this.timeSpan, 'months').toDate();\r\n    }\r\n    async payInterest() {\r\n        await firstValueFrom(this.http.post(this.baseUrl + 'clients/' + this.params.clientId + '/credit/' + this.params.creditId + '/pay-interest', null));\r\n        alert('Готово!');\r\n    }\r\n    async close() {\r\n        await firstValueFrom(this.http.post(this.baseUrl + 'clients/' + this.params.clientId + '/credit/' + this.params.creditId + '/close', null));\r\n        alert('Депозит закрыт.');\r\n        await this.ngOnInit();\r\n    }\r\n}\r\nCreditComponent.ɵfac = function CreditComponent_Factory(t) { return new (t || CreditComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i3.RouterParamsService), i0.ɵɵdirectiveInject('BASE_URL')); };\r\nCreditComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: CreditComponent, selectors: [[\"app-credit\"]], decls: 2, vars: 0, template: function CreditComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"p\");\r\n        i0.ɵɵtext(1, \"credit works!\");\r\n        i0.ɵɵelementEnd();\r\n    } }, styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJjcmVkaXQuY29tcG9uZW50LmNzcyJ9 */\"] });\r\n"]},"metadata":{},"sourceType":"module"}